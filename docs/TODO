* Local functions are suboptimal; they could be optimized a little.
